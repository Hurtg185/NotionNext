@tailwind base;
@tailwind components;
@tailwind utilities;

/* =================================================================
   全局基础样式
   ================================================================= */
@layer base {
  html {
    overflow-x: hidden;
    scroll-behavior: smooth; /* 增加平滑滚动 */
  }

  /* 图片默认样式 */
  img {
    display: unset;
  }
}

/* =================================================================
   组件样式 (Components)
   使用 @layer components 可以避免覆盖 Tailwind 的工具类
   ================================================================= */
@layer components {
  .wrapper {
    min-height: 100vh;
    display: flex;
    flex-wrap: nowrap;
    align-items: stretch;
    justify-content: flex-start;
    flex-direction: column;
  }

  /* 导航栏样式 */
  .sticky-nav {
    position: sticky;
    z-index: 10;
    top: -1px; /* 修复吸顶时的 1px 缝隙 */
    transition: all 0.5s cubic-bezier(0.4, 0, 0, 1);
    border-bottom-color: transparent;
    /* 默认开启磨砂效果 */
    -webkit-backdrop-filter: blur(5px);
    backdrop-filter: blur(5px);
  }

  /* 不支持 backdrop-filter 的浏览器回退方案 */
  @supports not (backdrop-filter: blur(5px)) {
    .sticky-nav {
      background-color: rgba(255, 255, 255, 0.9);
    }
    .dark .sticky-nav {
      @apply bg-gray-800; /* 使用 Tailwind 类处理暗色模式 */
    }
  }

  .sticky-nav-full {
    @apply border-b border-gray-200 border-opacity-50 dark:border-gray-600 dark:border-opacity-50;
  }

  .sticky-nav-full .nav {
    @apply text-gray-600 dark:text-gray-300;
  }

  .header-name {
    overflow: hidden;
  }

  @media (min-width: 768px) {
    .sticky-nav-full {
      @apply max-w-full;
    }
    .header-name {
      display: block;
      transition: all 0.5s cubic-bezier(0.4, 0, 0, 1);
    }
    .sticky-nav-full .header-name {
      @apply text-gray-600 dark:text-gray-300;
    }
  }

  nav {
    flex-wrap: wrap;
    line-height: 1.5em;
  }

  /* 阴影卡片 */
  .shadow-card {
    box-shadow:
      rgba(0, 0, 0, 0.07) 0px 1px 2px,
      rgba(0, 0, 0, 0.07) 0px 2px 4px,
      rgba(0, 0, 0, 0.07) 0px 4px 8px,
      rgba(0, 0, 0, 0.07) 0px 8px 16px,
      rgba(0, 0, 0, 0.07) 0px 16px 32px,
      rgba(0, 0, 0, 0.07) 0px 32px 64px;
  }

  /* 玻璃拟态 */
  .glassmorphism {
    background: hsla(0, 0%, 100%, 0.05);
    -webkit-backdrop-filter: blur(10px);
    backdrop-filter: blur(10px);
  }

  /* 评论区样式修正 */
  [data-waline] p {
    color: var(--waline-color);
    @apply dark:text-gray-200 !important;
  }

  .waline-recent-content p {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  /* Emoji 对齐修正 */
  .waline-recent-content .wl-emoji,
  .vcontent .wl-emoji {
    display: inline-block !important;
    vertical-align: baseline !important;
    height: 1.25em !important;
    margin: 0 0.25em !important;
  }

  /* Twikoo 样式 */
  .tk-main a {
    @apply text-blue-700;
  }

  .el-loading-spinner {
    @apply flex items-center justify-center;
  }

  /* Webmention 样式 */
  .webmention-block {
    background: rgba(0, 116, 222, 0.2);
    padding: 1rem 2rem;
    border-radius: 5px;
  }

  .webmention-header {
    font-style: italic;
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 0.5rem;
  }

  .webmention-block-intro a {
    color: #0000ee;
    text-decoration: underline;
  }

  .webmention {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(0, 0, 0, 0.2);
  }

  .webmention-counts {
    padding: 16px 0;
    font-weight: bold;
  }

  .webmention-counts .count {
    font-weight: bold;
    margin-right: 0.2rem;
  }

  .webmention-counts .counts > span:not(:last-child):after {
    content: ' • ';
  }

  a.avatar-wrapper {
    display: inline-block;
    width: 50px;
    height: 50px;
    position: relative;
  }

  .webmention-avatars .avatar-wrapper {
    margin-right: -8px;
  }

  .avatar {
    border-radius: 50%;
    margin: 0;
    border: 3px solid rgba(0, 116, 222, 0.5);
  }

  .replies {
    margin: 0;
    padding: 0;
  }

  .reply {
    list-style: none;
    display: flex;
    position: relative;
    padding: 0;
    align-items: flex-start;
    margin-top: 0.6rem;
  }

  .reply p {
    margin: 0;
  }

  .reply .text {
    margin-left: 1rem;
    font-size: 14px;
  }

  .reply-author-name {
    font-weight: 500;
  }

  /* 图片懒加载骨架屏动画 */
  .lazy-image-placeholder {
    background-color: #f2f2f2;
    background-image: linear-gradient(
      90deg,
      rgba(0, 0, 0, 0.06) 33%,
      rgba(0, 0, 0, 0.3) 50%,
      rgba(0, 0, 0, 0.06) 66%
    );
    background-size: 300% 100%;
    animation: l1 1s infinite linear;
  }
}

/* =================================================================
   工具类 (Utilities)
   通用的小工具样式
   ================================================================= */
@layer utilities {
  /* 隐藏滚动条 (兼容写法) */
  .scroll-hidden,
  .article-tags,
  .tag-container ul {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
  }

  .scroll-hidden::-webkit-scrollbar,
  .article-tags::-webkit-scrollbar,
  .tag-container ul::-webkit-scrollbar {
    display: none;
    width: 0 !important;
  }

  /* 禁止选中 */
  .tag-container ul,
  .forbid-copy {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  .gt-meta {
    @apply dark:text-gray-300;
  }

  /* Live2D 看板娘定位修正 */
  #waifu {
    @apply left-0 right-auto z-50 hidden lg:block !important; /* z-index 调高防止被遮挡 */
  }

  .medium-zoom-overlay {
    background: none !important;
  }

  .shadow-text {
    text-shadow: 0.1em 0.1em 0.2em black;
  }

  .notion-code-copy-button > svg {
    pointer-events: none;
  }

  .fireworks {
    position: fixed;
    left: 0;
    top: 0;
    z-index: 1000;
    pointer-events: none;
  }

  .writing-vertical {
    writing-mode: vertical-rl;
    text-orientation: upright;
  }

  .adsbygoogle {
    overflow: hidden;
  }
}

/* =================================================================
   动画定义
   ================================================================= */
@keyframes l1 {
  0% {
    background-position: right;
  }
}

/* =================================================================
   特定媒体查询调整
   ================================================================= */
/* Chatbase 移动端适配 */
@media (max-width: 700px) {
  button#chatbase-bubble-button {
    margin-bottom: 42px;
    margin-right: 20px;
  }
}
